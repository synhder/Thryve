<form class="{{cssClass}} flexrow" autocomplete="off">

  {{!-- Left Sidebar --}}
  <aside class="sidebar">
    
    {{!-- Character Portrait --}}
    <div class="profile">
      <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
    </div>

    {{!-- Identity --}}
    <div class="identity-display">
      <label>Identity</label>
      {{#if system.identity.name}}
        <div class="identity-name">{{system.identity.name}}</div>
      {{else}}
        <button type="button" class="identity-choose">Choose Identity</button>
      {{/if}}
    </div>

    {{!-- Carapace --}}
    <div class="carapace-sidebar">
      <h3>Carapace</h3>
      {{#if system.carapace.name}}
        <div class="carapace-name">{{system.carapace.name}}</div>
        <p class="carapace-ability"><em>{{system.carapace.ability}}</em></p>
      {{else}}
        <button type="button" class="carapace-choose">
          <i class="fas fa-bug"></i> Choose Carapace
        </button>
      {{/if}}
    </div>

    {{!-- Combat Stats --}}
    <div class="combat-stats">
      <h3>Combat Stats</h3>
      
      <div class="stat-block">
        <label>DV (Dodge)</label>
        <span class="stat-value">{{system.dv.value}}</span>
      </div>

      <div class="stat-block">
        <label>Movement</label>
        <span class="stat-value">{{system.movement.value}}m</span>
      </div>
    </div>

    {{!-- Resistances --}}
    <div class="resistances">
      <h3>Resistances</h3>
      
      <div class="resistance-block">
        <label>Biological</label>
        <span class="resistance-value">{{system.resistances.biological.value}}</span>
      </div>

      <div class="resistance-block">
        <label>Arcane</label>
        <span class="resistance-value">{{system.resistances.arcane.value}}</span>
      </div>

      <div class="resistance-block">
        <label>Tech</label>
        <span class="resistance-value">{{system.resistances.tech.value}}</span>
      </div>
    </div>

    {{!-- Biography --}}
    <div class="biography-sidebar">
      <h3>Biography</h3>
      {{editor enrichedBiography target="system.biography" button=true owner=owner editable=editable}}
    </div>

  </aside>

  {{!-- Main Content Area --}}
  <section class="main-content flexcol">
        
      {{!-- Attributes Section (Moved to Top) --}}
      <div class="attributes-header">
        <h3>Attributes</h3>
        <div class="attributes-grid">
          <div class="attribute-block">
            <label>STR</label>
            <input type="text" name="system.attributes.strength.value" value="{{system.attributes.strength.value}}" data-dtype="Number"/>
            <span class="mod">+{{system.attributes.strength.mod}}</span>
          </div>

          <div class="attribute-block">
            <label>AGL</label>
            <input type="text" name="system.attributes.agility.value" value="{{system.attributes.agility.value}}" data-dtype="Number"/>
            <span class="mod">+{{system.attributes.agility.mod}}</span>
          </div>

          <div class="attribute-block">
            <label>INT</label>
            <input type="text" name="system.attributes.intellect.value" value="{{system.attributes.intellect.value}}" data-dtype="Number"/>
            <span class="mod">+{{system.attributes.intellect.mod}}</span>
          </div>

          <div class="attribute-block">
            <label>CHA</label>
            <input type="text" name="system.attributes.charisma.value" value="{{system.attributes.charisma.value}}" data-dtype="Number"/>
            <span class="mod">+{{system.attributes.charisma.mod}}</span>
          </div>

          <div class="attribute-block">
            <label>WILL</label>
            <input type="text" name="system.attributes.willpower.value" value="{{system.attributes.willpower.value}}" data-dtype="Number"/>
            <span class="mod">+{{system.attributes.willpower.mod}}</span>
          </div>
        </div>
      </div>

      {{!-- Resources --}}
      <div class="resources">
        <div class="resource">
          <label>Body</label>
          <input type="text" name="system.body.value" value="{{system.body.value}}" data-dtype="Number"/>
          <span> / </span>
          <span class="max-value">{{system.body.max}}</span>
        </div>
        <div class="resource">
          <label>Stability</label>
          <input type="text" name="system.stability.value" value="{{system.stability.value}}" data-dtype="Number"/>
          <span> / </span>
          <span class="max-value">{{system.stability.max}}</span>
        </div>
        <div class="resource">
          <label>Humor</label>
          <input type="text" name="system.humor.value" value="{{system.humor.value}}" data-dtype="Number"/>
          <span> / </span>
          <span class="max-value">{{system.humor.max}}</span>
        </div>
        <button type="button" class="level-up-button">
          <i class="fas fa-arrow-up"></i> Level Up
        </button>
        <button type="button" class="cast-spell-button">
          <i class="fas fa-magic"></i> Cast Spell
        </button>
      </div>
    </header>

    {{!-- Tab Navigation --}}
    <nav class="sheet-tabs tabs" data-group="primary">
      <a class="item" data-tab="skills">Skills</a>
      <a class="item" data-tab="inventory">Inventory</a>
    </nav>

    {{!-- Tab Content --}}
    <div class="sheet-body">

      {{!-- Skills Tab --}}
      <div class="tab skills" data-group="primary" data-tab="skills">
        <h3>Skills</h3>
        <ol class="skills-list">
          <li class="skill-header flexrow">
            <div class="skill-name">Skill</div>
            <div class="skill-die">Die</div>
            <div class="skill-attribute">Attribute</div>
            <div class="skill-controls">Roll</div>
          </li>

          {{!-- Force --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.force.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.force.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.force.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="force"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Influence --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.influence.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.influence.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.influence.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="influence"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Resolve --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.resolve.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.resolve.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.resolve.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="resolve"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Awareness --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.awareness.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.awareness.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.awareness.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="awareness"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Mobility --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.mobility.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.mobility.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.mobility.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="mobility"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Finesse --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.finesse.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.finesse.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.finesse.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="finesse"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Deception --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.deception.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.deception.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.deception.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="deception"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>

          {{!-- Systems --}}
          <li class="skill flexrow">
            <div class="skill-name">{{system.skills.systems.label}}</div>
            <div class="skill-die">
              <span class="die-display">{{system.skills.systems.die}}</span>
            </div>
            <div class="skill-attribute">{{system.skills.systems.attribute}}</div>
            <div class="skill-controls">
              <a class="skill-roll" data-skill="systems"><i class="fas fa-dice-d20"></i></a>
            </div>
          </li>
        </ol>
      </div>

      {{!-- Inventory Tab --}}
      <div class="tab inventory" data-group="primary" data-tab="inventory">
        
        {{!-- Weapons --}}
        <h3>Weapons</h3>
        <ol class="items-list">
          <li class="item-header flexrow">
            <div class="item-name">Name</div>
            <div class="item-prop">Attack Die</div>
            <div class="item-prop">Damage Die</div>
            <div class="item-prop">Range</div>
            <div class="item-controls">
              <a class="item-control item-create" data-type="weapon" title="Create Weapon">
                <i class="fas fa-plus"></i>
              </a>
            </div>
          </li>

          {{#each weapons as |item id|}}
          <li class="item flexrow" data-item-id="{{item._id}}">
            <div class="item-name">
              <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
              <h4>{{item.name}}</h4>
            </div>
            <div class="item-prop">{{item.system.attackDie}}</div>
            <div class="item-prop">{{item.system.damageDie}}</div>
            <div class="item-prop">{{item.system.range}}</div>
            <div class="item-controls">
              <a class="item-control weapon-attack" data-item-id="{{item._id}}" title="Roll Attack">
                <i class="fas fa-crosshairs"></i>
              </a>
              <a class="item-control weapon-damage" data-item-id="{{item._id}}" title="Roll Damage">
                <i class="fas fa-burst"></i>
              </a>
              <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
              <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
            </div>
          </li>
          {{/each}}
        </ol>

        {{!-- Armor --}}
        <h3>Armor</h3>
        <ol class="items-list">
          <li class="item-header flexrow">
            <div class="item-name">Name</div>
            <div class="item-prop">DR</div>
            <div class="item-prop">ArP</div>
            <div class="item-prop">Weight</div>
            <div class="item-controls">
              <a class="item-control item-create" data-type="armor" title="Create Armor">
                <i class="fas fa-plus"></i>
              </a>
            </div>
          </li>

          {{#each armor as |item id|}}
          <li class="item flexrow" data-item-id="{{item._id}}">
            <div class="item-name">
              <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
              <h4>{{item.name}}</h4>
            </div>
            <div class="item-prop">{{item.system.dr}}</div>
            <div class="item-prop">{{item.system.armorPoints}}</div>
            <div class="item-prop">{{item.system.weight}}</div>
            <div class="item-controls">
              <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
              <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
            </div>
          </li>
          {{/each}}
        </ol>

        {{!-- Items --}}
        <h3>Items</h3>
        <ol class="items-list">
          <li class="item-header flexrow">
            <div class="item-name">Name</div>
            <div class="item-prop">Qty</div>
            <div class="item-prop">Weight</div>
            <div class="item-controls">
              <a class="item-control item-create" data-type="item" title="Create Item">
                <i class="fas fa-plus"></i>
              </a>
            </div>
          </li>

          {{#each items as |item id|}}
          <li class="item flexrow" data-item-id="{{item._id}}">
            <div class="item-name">
              <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
              <h4>{{item.name}}</h4>
            </div>
            <div class="item-prop">{{item.system.quantity}}</div>
            <div class="item-prop">{{item.system.weight}}</div>
            <div class="item-controls">
              <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
              <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
            </div>
          </li>
          {{/each}}
        </ol>
      </div>

    </div>
  </section>

</form>